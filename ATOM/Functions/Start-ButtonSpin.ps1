function Start-ButtonSpin {
    param (
        [Parameter(Mandatory)]
        $button = $_
    )

    $animation = New-Object System.Windows.Media.Animation.DoubleAnimation
    $animation.From = 0
    $animation.To = 360
    $animation.Duration = New-Object Windows.Duration (New-Object TimeSpan 0,0,0,0,500)
    $animation.EasingFunction = New-Object System.Windows.Media.Animation.QuadraticEase
    $animation.EasingFunction.EasingMode = [System.Windows.Media.Animation.EasingMode]::EaseInOut

    $rotateTransform = New-Object System.Windows.Media.RotateTransform
    $button.RenderTransform = $rotateTransform
    $button.RenderTransformOrigin = '0.5,0.5'

    $rotateTransform.BeginAnimation([System.Windows.Media.RotateTransform]::AngleProperty, $animation)
}